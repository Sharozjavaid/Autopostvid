[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisord.log
pidfile=/var/run/supervisord.pid

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock

[unix_http_server]
file=/var/run/supervisor.sock
chmod=0700

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

# =============================================================================
# SCHEDULED PRODUCTION - Runs 3 times daily (9 pieces total)
# =============================================================================
# Schedule (PST):
# - 9:00 AM: 1 Slideshow + 1 Narration + 1 Video Transitions
# - 1:00 PM: 1 Slideshow + 1 Narration + 1 Video Transitions
# - 5:00 PM: 1 Slideshow + 1 Narration + 1 Video Transitions
#
# Each content is emailed with caption + #PhilosophizeMeApp hashtag
#
# STATUS: PAUSED (autostart=false)
# To enable: supervisorctl start production-scheduler
# =============================================================================

[program:production-scheduler]
command=python3 scheduled_production.py
directory=/app
autostart=true
autorestart=true
stderr_logfile=/var/log/production-scheduler.err.log
stdout_logfile=/var/log/production-scheduler.out.log

# =============================================================================
# STREAMLIT DASHBOARD - Always running for monitoring & manual control
# =============================================================================
[program:streamlit]
command=streamlit run app.py --server.port=8501 --server.address=0.0.0.0 --server.headless=true
directory=/app
autostart=true
autorestart=true
stderr_logfile=/var/log/streamlit.err.log
stdout_logfile=/var/log/streamlit.out.log

# =============================================================================
# FASTAPI BACKEND - New React frontend API + TikTok integration
# =============================================================================
[program:fastapi]
command=python -c "import sys; sys.path.insert(0, '/app/backend'); from uvicorn import run; run('app.main:app', host='0.0.0.0', port=8001)"
directory=/app
autostart=true
autorestart=true
stderr_logfile=/var/log/fastapi.err.log
stdout_logfile=/var/log/fastapi.out.log
